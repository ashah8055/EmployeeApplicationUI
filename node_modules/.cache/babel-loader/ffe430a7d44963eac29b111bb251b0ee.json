{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport * as React from 'react';\nimport { createElement, Component } from 'react';\nimport omit from 'omit.js';\nimport classNames from 'classnames';\n\nfunction getNumberArray(num) {\n  return num ? num.toString().split('').reverse().map(function (i) {\n    return Number(i);\n  }) : [];\n}\n\nvar ScrollNumber = function (_Component) {\n  _inherits(ScrollNumber, _Component);\n\n  function ScrollNumber(props) {\n    _classCallCheck(this, ScrollNumber);\n\n    var _this = _possibleConstructorReturn(this, (ScrollNumber.__proto__ || Object.getPrototypeOf(ScrollNumber)).call(this, props));\n\n    _this.state = {\n      animateStarted: true,\n      count: props.count\n    };\n    return _this;\n  }\n\n  _createClass(ScrollNumber, [{\n    key: 'getPositionByNum',\n    value: function getPositionByNum(num, i) {\n      if (this.state.animateStarted) {\n        return 10 + num;\n      }\n\n      var currentDigit = getNumberArray(this.state.count)[i];\n      var lastDigit = getNumberArray(this.lastCount)[i]; // 同方向则在同一侧切换数字\n\n      if (this.state.count > this.lastCount) {\n        if (currentDigit >= lastDigit) {\n          return 10 + num;\n        }\n\n        return 20 + num;\n      }\n\n      if (currentDigit <= lastDigit) {\n        return 10 + num;\n      }\n\n      return num;\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var _this2 = this;\n\n      if ('count' in nextProps) {\n        if (this.state.count === nextProps.count) {\n          return;\n        }\n\n        this.lastCount = this.state.count; // 复原数字初始位置\n\n        this.setState({\n          animateStarted: true\n        }, function () {\n          // 等待数字位置复原完毕\n          // 开始设置完整的数字\n          setTimeout(function () {\n            _this2.setState({\n              animateStarted: false,\n              count: nextProps.count\n            }, function () {\n              var onAnimated = _this2.props.onAnimated;\n\n              if (onAnimated) {\n                onAnimated();\n              }\n            });\n          }, 5);\n        });\n      }\n    }\n  }, {\n    key: 'renderNumberList',\n    value: function renderNumberList(position) {\n      var childrenToReturn = [];\n\n      for (var i = 0; i < 30; i++) {\n        var currentClassName = position === i ? 'current' : '';\n        childrenToReturn.push(React.createElement('p', {\n          key: i.toString(),\n          className: currentClassName\n        }, i % 10));\n      }\n\n      return childrenToReturn;\n    }\n  }, {\n    key: 'renderCurrentNumber',\n    value: function renderCurrentNumber(num, i) {\n      var position = this.getPositionByNum(num, i);\n      var removeTransition = this.state.animateStarted || getNumberArray(this.lastCount)[i] === undefined;\n      return createElement('span', {\n        className: this.props.prefixCls + '-only',\n        style: {\n          transition: removeTransition ? 'none' : undefined,\n          msTransform: 'translateY(' + -position * 100 + '%)',\n          WebkitTransform: 'translateY(' + -position * 100 + '%)',\n          transform: 'translateY(' + -position * 100 + '%)'\n        },\n        key: i\n      }, this.renderNumberList(position));\n    }\n  }, {\n    key: 'renderNumberElement',\n    value: function renderNumberElement() {\n      var _this3 = this;\n\n      var state = this.state;\n\n      if (!state.count || isNaN(state.count)) {\n        return state.count;\n      }\n\n      return getNumberArray(state.count).map(function (num, i) {\n        return _this3.renderCurrentNumber(num, i);\n      }).reverse();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          prefixCls = _props.prefixCls,\n          className = _props.className,\n          style = _props.style,\n          title = _props.title,\n          _props$component = _props.component,\n          component = _props$component === undefined ? 'sup' : _props$component; // fix https://fb.me/react-unknown-prop\n\n      var restProps = omit(this.props, ['count', 'onAnimated', 'component', 'prefixCls']);\n\n      var newProps = _extends({}, restProps, {\n        className: classNames(prefixCls, className),\n        title: title\n      }); // allow specify the border\n      // mock border-color by box-shadow for compatible with old usage:\n      // <Badge count={4} style={{ backgroundColor: '#fff', color: '#999', borderColor: '#d9d9d9' }} />\n\n\n      if (style && style.borderColor) {\n        newProps.style.boxShadow = '0 0 0 1px ' + style.borderColor + ' inset';\n      }\n\n      return createElement(component, newProps, this.renderNumberElement());\n    }\n  }]);\n\n  return ScrollNumber;\n}(Component);\n\nexport default ScrollNumber;\nScrollNumber.defaultProps = {\n  prefixCls: 'ant-scroll-number',\n  count: null,\n  onAnimated: function onAnimated() {}\n};","map":null,"metadata":{},"sourceType":"module"}